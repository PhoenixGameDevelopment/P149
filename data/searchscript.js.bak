//var olddoc = "";

//var test = 0;

self.port.on("resetdoc", function() {
  // Handle the message
 // olddoc = document.body.innerHTML;
 // document.body.innerHTML = olddoc;
  //console.log(olddoc);

});

self.port.on("search", function(olddoc,searchterm) {
  // Handle the message
  
  if(olddoc != ""){ //olddoc has been set
  document.body.innerHTML = olddoc; //reset page to unmodified version
  console.log("reset page...");
}
  else{
  olddoc = document.body.innerHTML; //store original version of page
  console.log("set page...");
  
  self.port.emit("sendolddoc",olddoc);
  
}

//console.log(test);
//test = 1;
  //console.log("searchterm: " + searchterm + olddoc);
  
 // document.body.innerHTML = olddoc;//.replace(new RegExp(searchterm,'g'),searchterm.fontcolor("yellow"));
 // document.body.innerHTML = olddoc;
  
  document.body.innerHTML = document.body.innerHTML.replace(new RegExp(searchterm,'g'),searchterm.fontcolor("yellow"));

});